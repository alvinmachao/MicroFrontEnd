{"version":3,"file":"tinySingleSpa.js","sources":["../src/applications/app.helper.js","../src/applications/app.js","../src/applications/timeout.js","../src/lifecyles/helper.js","../src/lifecyles/load.js","../src/lifecyles/unmount.js","../src/lifecyles/bootstrap.js","../src/lifecyles/mount.js","../src/navigation/hijackLocation.js","../src/navigation/index.js","../src/start.js"],"sourcesContent":["export const NOT_LOADED = \"NOT_LOADED\";\nexport const LOAD_SOURCE_CODE = \"LOAD_SOURCE_CODE\";\nexport const NOT_BOOTSTRAPED = \"NOT_BOOTSTRAPED\";\nexport const BOOTSTRAPPING = \"BOOTSTRAPPING\";\nexport const NOT_MOUNTED = \"NOT_MOUNTED\";\nexport const MOUNTTING = \"MOUNTTING\";\nexport const MOUNTED = \"MOUNTED\";\nexport const UNMOUNTTING = \"UNMOUNTTING\";\nexport const UPDATEING = \"UPDATEING\";\nexport const SKIP_BECAUSE_BROKEN = \"SKIP_BECAUSE_BROKEN\";\nexport const LOAD_ERROR = \"LOAD_ERROR\";\nexport const notBroken = function (app) {\n  return app.status !== SKIP_BECAUSE_BROKEN;\n};\nexport const notLoadError = function (app) {\n  return app.status !== LOAD_ERROR;\n};\nexport const isloaded = function (app) {\n  return (\n    app.status !== LOAD_ERROR &&\n    app.status !== NOT_LOADED &&\n    app.status !== LOAD_SOURCE_CODE\n  );\n};\nexport const isnotLoad = function (app) {\n  return !isloaded(app);\n};\nexport const shouldBeActive = function (app) {\n  try {\n    return app.activityWhen(window.location);\n  } catch (error) {\n    app.status = SKIP_BECAUSE_BROKEN;\n    console.log(error);\n  }\n};\nexport const shouldnotBeActive = function (app) {\n  try {\n    return !app.activityWhen(window.location);\n  } catch (error) {\n    app.status = SKIP_BECAUSE_BROKEN;\n    console.log(error);\n  }\n};\n\nexport const isActive = function (app) {\n  return app.status === MOUNTED;\n};\nexport const isnotActive = function (app) {\n  return !isActive(app);\n};\n","import {\n  NOT_LOADED,\n  notBroken,\n  notLoadError,\n  isnotLoad,\n  shouldBeActive,\n  isloaded,\n  isActive,\n  isnotActive,\n  shouldnotBeActive,\n} from \"./app.helper\";\nimport { invoke } from \"../navigation\";\n// const APPS = [];\nexport function getAppNames() {\n  return APPS.map((app) => {\n    return app.name;\n  });\n}\nexport const APPS = [];\nexport function getRawApps() {\n  return [...APPS];\n}\n/**\n * 注册微服务Application\n * @param {sting} appName\n * @param {function<promise>} loadFunction\n * @param {function <Boolean>} activeWhenFunction\n * @param {object} props\n * @return {promise}\n */\nexport function registerApplication(\n  appName,\n  loadFunction,\n  activeWhenFunction,\n  customProps = {}\n) {\n  if (!appName || typeof appName !== \"string\") {\n    throw new Error(`App name must be no-empty string`);\n  }\n  if (getAppNames().indexOf(appName) !== -1) {\n    throw new Error(\"There is already an app declared with name \" + appName);\n  }\n  if (typeof loadFunction !== \"function\") {\n    throw new Error(\"the application or load function is required\");\n  }\n  if (typeof customProps !== \"object\" || Array.isArray(customProps)) {\n    throw new Error(\"the customProps must be a pure object\");\n  }\n  if (typeof activeWhenFunction !== \"function\") {\n    throw new Error(\"the activityWhen must be a function\");\n  }\n\n  APPS.push({\n    name: appName,\n    loadApp: loadFunction,\n    activityWhen: activeWhenFunction,\n    status: NOT_LOADED,\n    customProps,\n    services: {},\n  });\n  return invoke();\n}\n/**\n * 获取满足加载条件的app\n * 1、没有加载中断\n * 2、没有加载错误\n * 3、没有被加载过\n * 4、满足app.activityWhen()\n * @return {*[]}\n */\nexport function getAppsToload() {\n  let loadPromise = APPS.filter(notBroken)\n    .filter(notLoadError)\n    .filter(isnotLoad)\n    .filter(shouldBeActive);\n  return loadPromise;\n}\n/**\n * 获取满足加载条件的app\n * 1、没有加载中断\n * 2、没有加载错误\n * 3、已经加载过\n * 4、mouted的\n * 5、不满足app.activityWhen()\n * @return {*[]}\n */\nexport function getUnmountApps() {\n  return APPS.filter(notBroken)\n    .filter(isloaded)\n    .filter(isActive)\n    .filter(shouldnotBeActive);\n}\n/**\n * 获取满足加载条件的app\n * 1、没有加载中断\n * 2、没有加载错误\n * 3、加载过的\n * 4、没有被mounted\n * 5、满足app.activityWhen()\n * @return {*[]}\n * .filter(isloaded)\n */\nexport function getAppsToMount() {\n  return APPS.filter(notBroken)\n    .filter(notLoadError)\n    .filter(isnotActive)\n    .filter(shouldBeActive);\n}\nexport function getMountedApps() {\n  return APPS.filter(isActive).map((item) => item.name);\n}\n","const TIMEOUTS = {\n  bootstrap: {\n    milliseconds: 3000,\n    rejectWhenTimeout: false,\n  },\n  mount: {\n    milliseconds: 3000,\n    rejectWhenTimeout: false,\n  },\n  unmount: {\n    milliseconds: 3000,\n    rejectWhenTimeout: false,\n  },\n};\nexport function ensureTimeout(timeouts = {}) {\n  return Object.assign({}, timeouts, TIMEOUTS);\n}\nexport function reasonableTimeout(lifecyle, description, timeouts) {\n  return new Promise((resolve, reject) => {\n    let finish = false;\n    lifecyle\n      .then((data) => {\n        finish = true;\n        resolve(data);\n      })\n      .catch(() => {\n        finish = true;\n        reject();\n      });\n    setTimeout(() => {\n      if (finish) {\n        return;\n      }\n      let error = `${description} did not resolve or reject for ${timeouts.milliseconds} milliseconds`;\n      if (timeouts.rejectWhenTimeout) {\n        throw new Error(error);\n      } else {\n        console.log(error);\n      }\n    }, timeouts.milliseconds);\n  });\n}\n","/**\n *  生命周期 bootstrap\n    生命周期 mount\n    生命周期 unmount\n */\nexport const LIFECYLES = [\"bootstrap\", \"mount\", \"unmount\"];\nexport function smellLikePromise(p) {\n  if (p instanceof Promise) {\n    return true;\n  }\n  return (\n    typeof p === \"object\" &&\n    typeof p.then === \"function\" &&\n    typeof p.catch === \"function\"\n  );\n}\nexport function flattenLifecyleArray(lifecyles, description) {\n  if (!Array.isArray(lifecyles)) {\n    lifecyles = [lifecyles];\n  }\n  if (lifecyles.length === 0) {\n    lifecyles = [\n      () => {\n        Promise.resolve();\n      },\n    ];\n  }\n  return function (pros) {\n    return new Promise((resolve, reject) => {\n      function next(index) {\n        let fn = lifecyles[index](pros);\n        if (!smellLikePromise(fn)) {\n          reject(`${description} at index ${index} did not return a promise`);\n          return;\n        } else {\n          fn.then(() => {\n            if (index >= lifecyles.length - 1) {\n              resolve();\n            } else {\n              next(++index);\n            }\n          }).catch(reject);\n        }\n      }\n      next(0);\n    });\n  };\n}\nexport function getProps(app) {\n  return {\n    name: app.name,\n    ...app.customProps,\n  };\n}\n","import {\n  NOT_LOADED,\n  LOAD_ERROR,\n  LOAD_SOURCE_CODE,\n  NOT_BOOTSTRAPED,\n  SKIP_BECAUSE_BROKEN,\n} from \"../applications/app.helper\";\nimport { ensureTimeout } from \"../applications/timeout\";\nimport {\n  smellLikePromise,\n  LIFECYLES,\n  flattenLifecyleArray,\n  getProps,\n} from \"./helper\";\nexport function toLoadPromise(app) {\n  if (app.status !== NOT_LOADED && app.status !== LOAD_ERROR) {\n    return Promise.resolve(app);\n  }\n  app.status = LOAD_SOURCE_CODE;\n  let loadPromise = app.loadApp(getProps(app));\n  if (!smellLikePromise(loadPromise)) {\n    app.status = SKIP_BECAUSE_BROKEN;\n    return Promise.reject(new Error(\"\"));\n  }\n  return loadPromise\n    .then((appConfig) => {\n      if (typeof appConfig !== \"object\") {\n        throw new Error(\"\");\n      }\n\n      let errors = [];\n      LIFECYLES.forEach((lifecyle) => {\n        if (!appConfig[lifecyle]) {\n          errors.push(\n            `${lifecyle}:must be a function or function array not empty`\n          );\n        }\n      });\n      if (errors.length) {\n        app.status = SKIP_BECAUSE_BROKEN;\n        console.log(errors);\n        return;\n      }\n      app.status = NOT_BOOTSTRAPED;\n      app.bootstrap = flattenLifecyleArray(\n        appConfig.bootstrap,\n        `app:${app.name} bootsstrapping`\n      );\n      app.mount = flattenLifecyleArray(\n        appConfig.mount,\n        `app:${app.name} mountting`\n      );\n      app.unmount = flattenLifecyleArray(\n        appConfig.unmount,\n        `app:${app.name} unmountting`\n      );\n      app.timeouts = ensureTimeout(app.timeouts);\n      return app;\n    })\n    .catch((e) => {\n      app.status = LOAD_ERROR;\n      return app;\n    });\n}\n","import {\n  MOUNTED,\n  NOT_MOUNTED,\n  UNMOUNTTING,\n  SKIP_BECAUSE_BROKEN,\n} from \"../applications/app.helper\";\nimport { reasonableTimeout } from \"../applications/timeout\";\nimport { getProps } from \"./helper\";\n\nexport function unmountPromise(app) {\n  if (app.status !== MOUNTED) {\n    return Promise.resolve(app);\n  }\n  app.status = UNMOUNTTING;\n  // return reasonableTimeout(\n  //   app.unmount(getProps(app)),\n  //   `app: ${app.name} unmountting`,\n  //   app.timeouts.unmount\n  // )\n  return app\n    .unmount(getProps(app))\n    .then(() => {\n      app.status = NOT_MOUNTED;\n      return app;\n    })\n    .catch((e) => {\n      console.log(e);\n      app.status = SKIP_BECAUSE_BROKEN;\n      return app;\n    });\n}\n","import {\n  BOOTSTRAPPING,\n  NOT_BOOTSTRAPED,\n  SKIP_BECAUSE_BROKEN,\n  NOT_MOUNTED,\n} from \"../applications/app.helper\";\nimport { reasonableTimeout } from \"../applications/timeout\";\nimport { getProps } from \"./helper\";\n\nexport function toBootstrapPromise(app) {\n  console.log(\"toBootstrapPromise\");\n  if (app.status !== NOT_BOOTSTRAPED) {\n    return Promise.resolve(app);\n  }\n  app.status = BOOTSTRAPPING;\n  // return reasonableTimeout(\n  //   app.bootstrap(getProps(app)),\n  //   `app: ${app.name} bootstrapping`,\n  //   app.timeouts.bootstrap\n  // )\n  return app\n    .bootstrap(getProps(app))\n    .then(() => {\n      app.status = NOT_MOUNTED;\n      return app;\n    })\n    .catch((e) => {\n      console.log(e);\n      app.status = SKIP_BECAUSE_BROKEN;\n      return app;\n    });\n}\n","import {\n  MOUNTED,\n  MOUNTTING,\n  SKIP_BECAUSE_BROKEN,\n  NOT_MOUNTED,\n} from \"../applications/app.helper\";\nimport { reasonableTimeout } from \"../applications/timeout\";\nimport { getProps } from \"./helper\";\n\nexport function toMountPromise(app) {\n  console.log(\"mountApp\");\n  if (app.status !== NOT_MOUNTED) {\n    return Promise.resolve(app);\n  }\n  app.status = MOUNTTING;\n  // return reasonableTimeout(\n  //   app.mount(getProps(app)),\n  //   `app: ${app.name} moutting`,\n  //   app.timeouts.mount\n  // )\n  return app\n    .mount(getProps(app))\n    .then(() => {\n      app.status = MOUNTED;\n      return app;\n    })\n    .catch((e) => {\n      console.log(e);\n      app.status = SKIP_BECAUSE_BROKEN;\n      return app;\n    });\n}\n","import { invoke } from \"./index\";\nconst HIJACK_EVENTS_NAME = /^(popstate|hashchange)$/i;\nconst EVENTPOOL = {\n  popstate: [],\n  hashchange: [],\n};\nlet route = function () {\n  invoke([], arguments);\n};\nwindow.addEventListener(\"popstate\", route);\nwindow.addEventListener(\"hashchange\", route);\nconst originAddEventListener = window.addEventListener;\nconst originRemoveEventListener = window.removeEventListener;\nwindow.addEventListener = function (type, handler) {\n  if (type && HIJACK_EVENTS_NAME.test(type) && typeof handler === \"function\") {\n    EVENTPOOL[type].indexof(handler) === -1 && EVENTPOOL[type].push(handler);\n  } else {\n    originAddEventListener.apply(this, arguments);\n  }\n};\nwindow.removeEventListener = function (type, handler) {\n  if (type && HIJACK_EVENTS_NAME.test(type) && typeof handler === \"function\") {\n    let list = EVENTPOOL[type];\n    EVENTPOOL[type] =\n      list.indexof(handler) > -1\n        ? list.filter((han) => han !== handler)\n        : EVENTPOOL[type];\n  } else {\n    originRemoveEventListener.apply(this, arguments);\n  }\n};\nlet originPopstate = window.history.popstate;\nlet originReplacestate = window.history.replaceState;\nwindow.history.popstate = function (state, title, url) {\n  let result = originPopstate.apply(this, arguments);\n  route(mockPopStateEvent(state));\n  return result;\n};\nwindow.history.replaceState = function (state, title, url) {\n  let result = originReplacestate.apply(this, arguments);\n  route(mockPopStateEvent(state));\n  return result;\n};\n\nfunction mockPopStateEvent(state) {\n  return new PopStateEvent(\"popstate\", { state });\n}\n\nexport function callCapturedEvents(events) {\n  if (!events) {\n    return;\n  }\n  if (Array.isArray(events)) {\n    events = events[0];\n  }\n  let name = events.type;\n  if (!HIJACK_EVENTS_NAME.test(name)) {\n    return;\n  }\n  EVENTPOOL[name].forEach((handler) => handler.apply(window, eventArgs));\n}\n","import {\n  getAppsToload,\n  getUnmountApps,\n  getAppsToMount,\n  getMountedApps,\n} from \"../applications/app\";\nimport { isStart } from \"../start\";\nimport { toLoadPromise } from \"../lifecyles/load\";\nimport { unmountPromise } from \"../lifecyles/unmount\";\nimport { toBootstrapPromise } from \"../lifecyles/bootstrap\";\nimport { toMountPromise } from \"../lifecyles/mount\";\nimport { callCapturedEvents } from \"../navigation/hijackLocation\";\nlet loadAppUnderway = false;\nconst pendingPromise = [];\n\nexport function invoke(pendings = [], events) {\n  if (loadAppUnderway) {\n    // 添加到pendingPromise中等待执行\n    return new Promise((resolve, reject) => {\n      pendingPromise.push({ resolve, reject, events });\n    });\n  }\n  if (isStart()) {\n    performAppChanges();\n  } else {\n    loadApps();\n  }\n  // load app;\n  function loadApps() {\n    let promiseLoadApps = getAppsToload().map(toLoadPromise);\n    console.log(\"promiseLoadApps:\", promiseLoadApps);\n    Promise.all(promiseLoadApps)\n      .then(() => {\n        callAllLocationEvent();\n        return finish();\n      })\n      .catch((e) => {\n        callAllLocationEvent();\n        console.log(e);\n      });\n  }\n  // 启动app\n  function performAppChanges() {\n    // unmout app\n    let unmountApps = getUnmountApps();\n    console.log(\"unmountApps:\", unmountApps);\n    let unmountAppsPromise = Promise.all(unmountApps.map(unmountPromise));\n    // load app\n    // let loadApps = getAppsToload();\n    // console.log(\"loadApps:\", loadApps);\n    // let loadPromises = loadApps.map((app) => {\n    //   return toLoadPromise(app)\n    //     .then((app) => toBootstrapPromise(app))\n    //     .then(() => unmountAppsPromise)\n    //     .then(() => toMountPromise(app));\n    // });\n\n    // mount app\n    let mountApps = getAppsToMount();\n    console.log(\"mountApps:\", mountApps);\n    // mountApps = mountApps.filter((app) => loadApps.indexOf(app) === -1);\n    let mountPromise = mountApps.map((app) => {\n      return toLoadPromise(app)\n        .then(() => toBootstrapPromise(app))\n        .then(() => unmountAppsPromise)\n        .then(() => toMountPromise(app));\n    });\n    return unmountAppsPromise.then(\n      () => {\n        // let loadAndMountPromise = mountPromise;\n        // console.log(\"loadAndMountPromise:\", loadAndMountPromise);\n        return Promise.all(mountPromise).then(\n          () => {\n            callAllLocationEvent();\n            finish();\n          },\n          (ex) => {\n            pendings && pendings.forEach((item) => item.reject(ex));\n            throw ex;\n          }\n        );\n      },\n      (e) => {\n        callAllLocationEvent();\n        console.log(e);\n        throw e;\n      }\n    );\n  }\n  function finish() {\n    let resoveValue = getMountedApps();\n    if (pendings) {\n      pendings.forEach((pend) => {\n        pend.resolve(resoveValue);\n      });\n    }\n    loadAppUnderway = false;\n    if (pendingPromise.length) {\n      let backUp = pendingPromise;\n      pendingPromise = [];\n      return invoke(backUp);\n    }\n    return resoveValue;\n  }\n  function callAllLocationEvent() {\n    pendings &&\n      pendings.length &&\n      pendings.forEach((pend) => {\n        pend.events && callCapturedEvents(pend.events);\n      });\n    events && callCapturedEvents(events);\n  }\n}\n","import { invoke } from \"./navigation\";\nlet startFlag = false;\nexport function start() {\n  if (!startFlag) {\n    startFlag = true;\n    return invoke();\n  }\n}\nexport function isStart() {\n  return startFlag;\n}\n"],"names":["NOT_LOADED","LOAD_SOURCE_CODE","NOT_BOOTSTRAPED","BOOTSTRAPPING","NOT_MOUNTED","MOUNTTING","MOUNTED","UNMOUNTTING","SKIP_BECAUSE_BROKEN","LOAD_ERROR","notBroken","app","status","notLoadError","isloaded","isnotLoad","shouldBeActive","activityWhen","window","location","error","console","log","shouldnotBeActive","isActive","isnotActive","getAppNames","APPS","map","name","getRawApps","registerApplication","appName","loadFunction","activeWhenFunction","customProps","Error","indexOf","Array","isArray","push","loadApp","services","invoke","getAppsToload","loadPromise","filter","getUnmountApps","getAppsToMount","getMountedApps","item","TIMEOUTS","bootstrap","milliseconds","rejectWhenTimeout","mount","unmount","ensureTimeout","timeouts","Object","assign","LIFECYLES","smellLikePromise","p","Promise","then","catch","flattenLifecyleArray","lifecyles","description","length","pros","resolve","reject","next","index","fn","getProps","toLoadPromise","appConfig","errors","forEach","lifecyle","e","unmountPromise","toBootstrapPromise","toMountPromise","HIJACK_EVENTS_NAME","EVENTPOOL","popstate","hashchange","route","arguments","addEventListener","originAddEventListener","originRemoveEventListener","removeEventListener","type","handler","test","indexof","apply","list","han","originPopstate","history","originReplacestate","replaceState","state","title","url","result","mockPopStateEvent","PopStateEvent","callCapturedEvents","events","eventArgs","loadAppUnderway","pendingPromise","pendings","isStart","performAppChanges","loadApps","promiseLoadApps","all","callAllLocationEvent","finish","unmountApps","unmountAppsPromise","mountApps","mountPromise","ex","resoveValue","pend","backUp","startFlag","start"],"mappings":"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"}